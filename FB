local Players = game:GetService("Players")
local CollectionService = game:GetService("CollectionService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

-- Function to create a highlight on a part or model
local function createHighlight(target)
    -- Avoid duplicating highlights
    if target:FindFirstChildOfClass("Highlight") then return end

    local highlight = Instance.new("Highlight")
    highlight.Name = "InteractionHighlight"
    highlight.FillColor = Color3.fromRGB(255, 255, 0) -- Yellow fill
    highlight.OutlineColor = Color3.fromRGB(255, 255, 255) -- White outline
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    highlight.Parent = target
end

-- Function to remove all interaction highlights
local function removeAllHighlights()
    for _, obj in ipairs(CollectionService:GetTagged("Interactive")) do
        local highlight = obj:FindFirstChild("InteractionHighlight")
        if highlight then
            highlight:Destroy()
        end
    end
end

-- Function to handle click events
local function onClick()
    removeAllHighlights()
    for _, obj in ipairs(CollectionService:GetTagged("Interactive")) do
        createHighlight(obj)
    end
end

-- Connect click event to parts/models with ClickDetectors
for _, obj in ipairs(workspace:GetDescendants()) do
    if obj:IsA("BasePart") and obj:FindFirstChildOfClass("ClickDetector") then
        obj:FindFirstChildOfClass("ClickDetector").MouseClick:Connect(onClick)
    end
end
